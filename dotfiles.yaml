Neovim:
  - links:
      nvim: .config/nvim
  - run:
    - 'nvim --headless +q'
    - 'pip3 install --user --upgrade neovim-remote'


Tmux:
  - links:
      tmux: .config/tmux


Zathura:
  - links:
      zathura: .config/zathura
  - run:
    - 'xdg-mime default org.pwmt.zathura.desktop application/pdf'
  - flavours: zathura


Git:
  - links:
      gitconfig: .config/git/config


Kitty:
  - needs:
    - Fonts
  - links:
      kitty: .config/kitty
  - run:
    - 'touch ~/.config/kitty/local.conf'
  - flavours: kitty


Redshift:
  - links:
      redshift.conf: .config/redshift.conf


Bat:
  - links:
      bat.conf: .config/bat/config


Fish:
  - links:
      fish: .config/fish
  - run:
    - [sudo, mkdir, -p, /root/.config]
    - [sudo, cp, -r, fish, /root/.config/]
  - flavours: fzf


Bash:
  - links:
      bash/bashrc: .bashrc
      bash/bash_profile: .bash_profile


Rofi:
  - needs:
    - Fonts
  - links:
      rofi: .config/rofi
  - install:
    - scripts/rofi-open
    - scripts/rofi-vpn
    - scripts/rofi-ff
    - scripts/rofi-emoji
    - scripts/rofi-scripts
    - scripts/rofi-inputs
    - scripts/rofi-xrandr
    - scripts/rofi-askpass
  - profile:
    - rofi-askpass
  - flavours:
    - rofi


Fonts:
  - hooks:
    - fonts/install_fira_code_nerd_fonts.sh --global
    - fonts/install_fira_fonts.sh           --global
    - fonts/install_symbols_nerd_font.sh    --global


Npm:
  - run:
    - 'mkdir -p "$HOME/.node_modules"'
    - 'npm config set prefix "$HOME/.node_modules"'


Thinkpad:
  - links:
      Thinkpad/Xkbmap: .Xkbmap
  - install:
    - scripts/kbbacklight_toggle
    - scripts/backlight


Thinkpad-X:
  - target :
    - Thinkpad
  - system-install:
    - Thinkpad/xorg-conf


Flavours:
  - needs:
    - Rust
  - links:
      flavours: .config/flavours
      flavours/templates: .local/share/flavours/base16/templates/custom/templates
  - install:
    - scripts/flav
    - flavours/schemes
  - hooks:
    - setup/flavours.sh


FlatWaita-16:
  - install:
    - scripts/propagate-theme
  - hooks:
    - setup/FlatWaita-16.sh
  - flavours:
    - FlatWaita-16
  - run:
    - ~/.local/bin/propagate-theme


Rust:
  - hooks:
    - setup/rustup.sh


Sway:
  - links:
      Sway/sway: .config/sway
      Sway/waybar: .config/waybar
      Sway/swaylock: .config/swaylock
  - install:
    - scripts/start-polkit-agent
    - scripts/wlock
  - system-install:
    - Sway/mysway
  - flavours: [sway, waybar, rofi, mako]


Greetd:
  - system-install:
    - greetd


Qutebrowser:
  - links:
      qutebrowser.py: ~/.config/qutebrowser/config.py
  - run:
    - 'xdg-mime default org.qutebrowser.qutebrowser.desktop x-scheme-handler/http{,s}'
  - flavours: qutebrowser


Qutebrowser Flatpak:
  - links:
      qutebrowser.py: ~/.var/app/org.qutebrowser.qutebrowser/config/qutebrowser/config.py
  - run:
    - 'xdg-mime default org.qutebrowser.qutebrowser.desktop x-scheme-handler/http{,s}'
    - 'ln -s ~/.config/qutebrowser ~/.var/app/org.qutebrowser.qutebrowser/config/qutebrowser'
    - 'sudo flatpak override --filesystem=./qutebrowser.py org.qutebrowser.qutebrowser'


Wallpaper:
  - install:
    - scripts/wm
  - hooks:
    - setup/wallpaper.sh
  - flavours: wallpaper


I3:
  - needs:
    - Rofi
    - Redshift
  - links:
      I3/config: .config/i3/config
      I3/polybar: .config/polybar
  - install:
    - scripts/start-polkit-agent
  - flavours: [i3, polybar, dunst]


Profile:
  - links:
      profile: .profile
  - run:
    - mkdir -p ~/.profile.d


Fedora I3:
  - hooks:
    - setup/fedora-common.sh
    - setup/fedora-i3.sh
  - links:
      I3/xinitrc: .xinitrc
  - needs:
    - Desktop
    - I3
    - Lightdm
  # - run:
  #   - [sudo, systemctl, start, lightdm]


Lighdm:
  - needs:
    - FlatWaita-16
    - Wallpaper
    - Fonts
  - install:
    - I3/lightdm


Fedora Sway:
  - hooks:
    - setup/fedora-common.sh
    - setup/fedora-sway.sh
  - needs:
    - Sway
    - Desktop
    - Wallpaper
    - Greetd
  - run:
    - [sudo, systemctl, start, greetd]


Server:
  - needs:
    - Neovim
    - Bash
    - Fish
    - Tmux
    - Bat


Desktop:
  - needs:
    - Server
    - Fonts
    - Git
    - Kitty
    - Zathura
    - Npm
    - Qutebrowser
    - Wallpaper
    - Flavours


Sway Silverblue:
  - needs:
    - Sway
    - Bash
    - Bat
    - Fish
    - Fonts
    - Git
    - Kitty
    - Neovim
    - Rofi
    - Tmux
    - Zathura
    - Qutebrowser Flatpak
  - run:
    - echo "blacklist pcspkr" | sudo tee /etc/modprobe.d/blacklist-pcspkr.conf > /dev/null

# vim: nowrap
